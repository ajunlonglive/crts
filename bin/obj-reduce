#!/bin/sh -eu

# remove everything but geometry from the model, since we calculate normals on
# import and don't support anything else
scrub_() {
	awk '
	/^v/ { print }
	/^f/ {
		printf "f "
		for (i = 2; i <= NF; ++i) {
			split($i, face, "/")
			printf face[1] " "
		}
		printf "\n"
	}'
}

in="$1"
out="$2"
epsilon="$3"
tmp="/tmp/$(echo "$in" | tr '/' '%')"

scrub_ < "$in" > "$tmp"
mv -v "$tmp" "$out"
