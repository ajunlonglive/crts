#!/bin/sh -eu

build=$1
app=crts.app
buildtype=debug

rm -rf "$app"

if [ -d "$build" ]; then
	reconf="--reconfigure"
else
	reconf=""
fi

meson $reconf\
	--prefix="$PWD/$app" \
        --bindir=Contents/MacOS \
	-Dopengl-ui=true \
	-Dncurses-ui=false \
	-Dbuild-macos-app=true \
	--buildtype="$buildtype" \
        $build

ninja -C "$build"
ninja -C "$build" install

zip -r ${app}.zip $app
