src = files([
	'../shared/constants/blueprints.c',
	'../shared/constants/globals.c',
	'../shared/math/geom.c',
	'../shared/math/perlin.c',
	'../shared/messaging/server_message.c',
	'../shared/net/ack.c',
	'../shared/net/bind_sock.c',
	'../shared/net/connection.c',
	'../shared/net/defs.c',
	'../shared/net/msg_queue.c',
	'../shared/net/net_ctx.c',
	'../shared/net/pool.c',
	'../shared/net/recv_msgs.c',
	'../shared/net/send_msgs.c',
	'../shared/serialize/base.c',
	'../shared/serialize/client_message.c',
	'../shared/serialize/geom.c',
	'../shared/serialize/net.c',
	'../shared/serialize/server_message.c',
	'../shared/sim/action.c',
	'../shared/sim/chunk.c',
	'../shared/sim/ent.c',
	'../shared/sim/world.c',
	'../shared/types/darr.c',
	'../shared/types/hash.c',
	'../shared/types/hdarr.c',
	'../shared/util/log.c',
	'../shared/util/mem.c',
	'../shared/util/time.c',
	'aggregate_msgs.c',
	'handle_msg.c',
	'main.c',
	'net.c',
	'opts.c',
	'sim/action.c',
	'sim/do_action.c',
	'sim/do_action/build.c',
	'sim/do_action/carry.c',
	'sim/do_action/fight.c',
	'sim/do_action/harvest.c',
	'sim/do_action/move.c',
	'sim/do_action/mount.c',
	'sim/do_action/dismount.c',
	'sim/ent_buckets.c',
	'sim/ent.c',
	'sim/environment.c',
	'sim/pathfind/heap.c',
	'sim/pathfind/meander.c',
	'sim/pathfind/pathfind.c',
	'sim/pathfind/pg_node.c',
	'sim/pathfind/pgraph.c',
	'sim/sim.c',
	'sim/terrain.c',
	'sim/worker.c',
])

deps = [libm]

crtsd_flags = ['-DCRTS_SERVER']

executable(
	'crtsd',
	include_directories: shared_inc,
	sources: src,
	dependencies: deps,
	install: true,
	c_args: crtsd_flags,
	link_args: crtsd_flags
)
